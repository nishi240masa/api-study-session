"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.app = void 0;
var _h = await jitiImport("h3");





var _omikuzi = await jitiImport("./src/omikuzi/omikuzi"); // h3:import

// ここでappを作成している
const app = exports.app = (0, _h.createApp)();

// ここでrouterを作成している
// routerとは、リクエストを受け取り、それに対するレスポンスを返すためのもの
const router = (0, _h.createRouter)();
app.use(router);

// GET,POST,PUT,DELETE
// GET: リソースの取得
// POST: リソースの作成
// PUT: リソースの更新
// DELETE: リソースの削除

// ここでGETリクエストを受け取る
router.get(
  "/",
  (0, _h.defineEventHandler)((event) => {
    return { message: "⚡️ Tadaa!" };
  })
);

// ここでPOSTリクエストを受け取る
router.post(
  "/",
  (0, _h.defineEventHandler)((event) => {
    return { message: "⚡️ Tadaa!" };
  })
);

// ここでPUTリクエストを受け取る
router.put(
  "/",
  (0, _h.defineEventHandler)((event) => {
    return { message: "⚡️ Tadaa!" };
  })
);

// ここでDELETEリクエストを受け取る
router.delete(
  "/",
  (0, _h.defineEventHandler)((event) => {
    return { message: "⚡️ Tadaa!" };
  })
);

// エンドポイントの設定
router.get(
  "/omikuji", //これがエンドポイント
  (0, _h.defineEventHandler)((event) => {
    (0, _h.setResponseHeader)(event, "Access-Control-Allow-Origin", "*"); // CORSを許可する
    // クエリパラメータから誕生日を取得
    const birthday = event.node.req.url.split("?birthday=")[1];
    if (!birthday) {
      return {
        error:
        "誕生日を指定してください。?birthday=YYYY-MM-DD の形式で指定してください。"
      };
    }

    // おみくじの結果を生成
    const fortune = (0, _omikuzi.getFortune)();
    return { birthday, fortune };
  })
);

// ここで実行環境を指定している
const port = process.env.PORT || 3000;
app.listen(port, () => {
  console.log(`Listening on port ${port}`);
}); /* v9-aeacb20c038815b7 */
